{% extends "base_generic.html" %}
{% load static %}

{% block content %}

{% include "includes/breadcrumb.html" with level=3 url2="administracao" page2="Acesso Restrito" current_page="Pessoas" %}

<div class="container">
    
    {% include "includes/create_header.html" with title="Pessoas" divider="administracao" list_url="cm_pessoa-list" %}
    
    <form method="post" action="">{% csrf_token %}
    
        {% include "includes/messages.html" %}
        
        <table class="table table-hover table-striped">
            <tr>
                <th>{{form.cpf.label}}:</th>
                <td>{{form.cpf}}</td>
            </tr>
            <tr>
                <th>{{form.nome.label}}:</th>
                <td>{{form.nome}}</td>
            </tr>
            <tr>
                <th>{{form.sexo.label}}:</th>
                <td>{{form.sexo}}</td>
            </tr>
            <tr>
                <th>{{form.data_nascimento.label}}:</th>
                <td>{{form.data_nascimento}}</td>
            </tr>
            <tr>
                <th>{{form.cep.label}}:</th>
                <td>{{form.cep}}</td>
            </tr>
            <tr>
                <th>{{form.rua.label}}:</th>
                <td>{{form.rua}}</td>
            </tr>
            <tr>
                <th>{{form.numero.label}}:</th>
                <td>{{form.numero}}</td>
            </tr>
            <tr>
                <th>{{form.bairro.label}}:</th>
                <td>{{form.bairro}}</td>
            </tr>
            <tr>
                <th>{{form.cidade.label}}:</th>
                <td>{{form.cidade}}</td>
            </tr>
            <tr>
                <th>{{form.uf.label}}:</th>
                <td>{{form.uf}}</td>
            </tr>
            <tr>
                <th>{{form.pais.label}}:</th>
                <td>{{form.pais}}</td>
            </tr>
            <tr>
                <th>{{form.telefone1.label}}:</th>
                <td class="d-flex">{{form.ddd1}}{{form.telefone1}}</td>
            </tr>
            <tr>
                <th>{{form.telefone2.label}}:</th>
                <td class="d-flex">{{form.ddd2}}{{form.telefone2}}</td>
            </tr>
            <tr>
                <th>{{form.email.label}}:</th>
                <td>{{form.email}}</td>
            </tr>
            <tr>
                <th>{{form.descricao_deficiencia.label}}:</th>
                <td>{{form.descricao_deficiencia}}</td>
            </tr>
        </table>
        {% include "includes/submit_button.html" with action="Cadastrar"%}
    
    </form>
</div>

<script>
    $(function(){
        $('#id_uf').select2();
        $('#id_pais').select2().val(21).change();

        $('#id_cep').on('change', async function(){
            const response = await fetch('https://viacep.com.br/ws/' + $('#id_cep').val().replace('-','') + '/json/');
            if(response.status == 200){
                var data = await response.json();
    
                $('#id_rua').val(data.logradouro);
                $('#id_complemento').val(data.complemento);
                $('#id_bairro').val(data.bairro);
                $('#id_uf').val(data.uf);
                $('#id_cidade').val(data.localidade);
                $('#id_uf').select2().val(data.uf).trigger('change');
            }
        })
    })
</script>

{% endblock %}